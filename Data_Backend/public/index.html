<!DOCTYPE html>
<html>
  <head>
    <title>SocketCluster</title>
    <link href="//fonts.googleapis.com/css?family=Roboto:100,300" rel="stylesheet" type="text/css">
    <link rel="icon" type="image/png" href="/favicon.ico">

    <link rel="stylesheet" href="style.css" type="text/css">
    <script type="text/javascript" src="/socketcluster.js"></script>

  </head>
  <body>

  <header>
    <h1 id="center">Sequence Cat</h1>
  </header>

  <div id="dump">
    <div id="drop_zone">
      <h2> Drop Your JSon File here</h2>
    </div>

    <input id="btn" type="file" style="display:none;" onchange="document.getElementById('file').value=this.value.substring(this.value.lastIndexOf('\\')+1);">
    <button id="browse" class="button" onclick="document.getElementById('btn').click()">Browse</button>

  </div>

  <div class="l-wrap" id="wrap">
  </div>

  <script type="text/javascript">
      // Initiate the connection to the server
      var messageSENDER= 0;
      var messageRECIEVER = 0;
      var userArray = [];





      var socket = socketCluster.connect();
      socket.on('error', function (err) {
          throw 'Socket error - ' + err;
      });
      socket.on('connect', function () {
          console.log('CONNECTED');
      });
      socket.on('word', function (data) {

          var currentdate = new Date();
          var datetime = currentdate.getMinutes() + ":"
              + currentdate.getSeconds();

          function checkUniqueUser(user){

              for (var i=0; i < userArray.length; i++) {

                  if (user === userArray[i]) {
                      return false;
                  }
              }
              userArray.push(user);
              return true;
          }

          var main = document.getElementById('wrap');
          var user = data.message[1]

          var uniqueUser = checkUniqueUser(data.message[1]);
          var message = data.message[2];
          if (uniqueUser == true)
          {



              main.innerHTML +=
                  '<div class="three-col-grid">' +
                  '<div class="grid-item">' +
                  '<section class="module">' +
                  '<div class="top-bar">' +
                  '<div class="left">'+
                  '<span class="icon typicons-message"></span>'+
                  '<h1 id="user"> ' + user + ' and ' +'</h1>'+
                  '</div>'+
                  '</div>'+
                  '<ol class="discussion">'+
                  '<li class="other" id="'+ userArray.indexOf(data.message[1])+ '">'+
                  '</li>'+
                  '<li class="self">' +
                  '<div class="messages">'+
                  '<p></p>'+
                  '</div>'+
                  '</li>'+
                  '<li class="other">'+
                  '</li>'+
                  '</ol>'+
                  '</section>'+
                  '</div>'+
                  '</div>';

          }
          else
          {

              var append = document.getElementById(userArray.indexOf(data.message[1]));
              append.innerHTML += '<div class="messages"> '+ '<p>' + message + '</p>'+
                  '<time>'+ user + 'â€¢' + datetime + '</time>' +
              '</div>' +'<br>'
              ;

          }


          //document.getElementById('user').innerHTML = data.from;
         // document.getElementById('message').innerHTML +=  data.message[2];
          console.log('RANDOM STREAM: ' + data.from + data.to + data.message);
      });

</script>

  </body>
</html>
